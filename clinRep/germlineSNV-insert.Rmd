#### Variant Summary

Summary of variants detected

```{r, eval=T, message=F}
D1=read.delim(data$SNVsummary)

VariantSummary=c("Total coding non-synonymous variants", "Total in Cancer Gene Census",
             "Total associated with drug response", "Total in pathways of interest",
             "Total other pathogenic VUS")
# write name to variable so we can evaluate intersections
Table1=cbind(VariantSummary, t(D1))

kable(Table1, rownames = F, caption="Summary of the variants detected")
```

#### TierA: Cancer Related

The following variants have been listed within the following sources:

* MSK's Oncokb Precision Oncology Database
* COSMIC's Cancer Gene Census (CGC): Tiers include Hallmark, Tier 1 & Tier 2 
* COSMIC's Cancer Mutation Census (Tiers 1-3) 

```{r, eval=T}
D2=read.delim(data$SNVcancerRes)

#BioVar=Xout$Func[ , (match(SearchTerms, colnames(Xout$Func)))]
#colnames(BioVar)=cNames
selectNames=c("SYMBOL","rsID", "HGVSp",	"EXON",	"Consequence","ProteinDomain",
              "Cancer.Disease.Freq","ClinVar.Disease", "HallmarkPathways","UserGeneList","CMC.Oncogene", "VAF",	 "ClinVar.Sig","CADD", "PolyPhen", "Genotype", "Depth", "CHROM",	"POS","HGVSc", "gnomAD.AF", "MGRB.AF" )
midx=match(selectNames, colnames(D2))
DT::datatable(D2[ , na.omit(midx)], rownames=F, filter = 'top', class='cell-border stripe',extensions="Buttons", options=list(dom="Bfrtip",scoller = TRUE, pageLength = 5,  buttons=c(I('colvis'),'csv', 'excel'), columnDefs = list(list(visible=FALSE, targets=c(13: length(na.omit(midx)))))))
```


#### Tier B: Biologically relevant pathways

The following variants have been implicated in pathways related to `r data$TreatmentKeywords`.
Additionally, variants need to either have a documented ClinVar Significance, or have a CADD score greater than 20

```{r, eval=T}
D3=read.delim(data$SNVHallmark)

midx=match(selectNames, colnames(D3))
DT::datatable(D3[ ,na.omit(midx)], rownames=F, filter = 'top', class='cell-border stripe',extensions="Buttons", options=list(dom="Bfrtip",scoller = TRUE, pageLength = 10,  buttons=c(I('colvis'),'csv', 'excel'), columnDefs = list(list(visible=FALSE, targets=c(11: length(na.omit(midx)))))))

```

#### Tier C: Variants with Clinvar protective or drug response annotations

The following variants annotated with clinvar have reported the following:

* a potential protective effect
* can influence drug response

```{r, eval=T}
D4=read.delim(data$SNVdrugresponse)

selectNames=c("SYMBOL","rsID", "HGVSp",	"EXON",	"Consequence","ProteinDomain","CADD", "PolyPhen", "gnomAD.AF", "MGRB.AF",
              "Cancer.Disease.Freq","ClinVar.Disease", "HallmarkPathways","UserGeneList", "VAF",  "ClinVar.Sig","Genotype", "Depth", "CHROM",	"POS","HGVSc"  )

midx=match(selectNames, colnames(D4))

DT::datatable(D4[ , na.omit(midx)], rownames=F, filter = 'top', class='cell-border stripe',extensions="Buttons", options=list(dom="Bfrtip",scoller = TRUE, pageLength = 5,  buttons=c(I('colvis'),'csv', 'excel'), columnDefs = list(list(visible=FALSE, targets=c(12:length(na.omit(midx)))))))
```

#### Tier D: Variants of unknown significance

The following variants:

* have a predicted CADD for for deleteriousness of 20+ (Top 1\% of deleteriousness)
* are present in the gnomAD database at an population frequency of 0.1 or less
* affect an defined functional domain of a protein

```{r, eval=T}
D5=read.delim(data$SNVVUS)

midx=match(selectNames, colnames(D5))

DT::datatable(D5[ ,na.omit(midx)], rownames=F, filter = 'top', class='cell-border stripe',extensions="Buttons", options=list(dom="Bfrtip",scoller = TRUE, pageLength = 5,  buttons=c(I('colvis'),'csv', 'excel'), columnDefs = list(list(visible=FALSE, targets=c(12:length(na.omit(midx)))))))
```

#### Tier E: ACMG variants

The following variants:

* have a variant in a ACMG listed gene 
* variant is predicted to be pathogenic or likely pathogenic by ACMG

```{r, eval=T}
D6=read.delim(data$SNVACMG)
midx=match(selectNames, colnames(D6))

DT::datatable(D6[ ,na.omit(midx)], rownames=F, filter = 'top', class='cell-border stripe',extensions="Buttons", options=list(dom="Bfrtip",scoller = TRUE, pageLength = 5,  buttons=c(I('colvis'),'csv', 'excel'), columnDefs = list(list(visible=FALSE, targets=c(12:length(na.omit(midx)))))))
```


